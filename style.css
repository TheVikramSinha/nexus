:root {
    --bg: #f3f4f6;
    --text: #111827;
    --line: #d1d5db;
    --accent: #2563eb;
    --node-bg: #ffffff;
    --highlight: #facc15;
}

body { margin: 0; height: 100vh; display: flex; flex-direction: column; font-family: 'JetBrains Mono', monospace; background: var(--bg); color: var(--text); overflow: hidden; }

/* TOOLBAR */
#toolbar { height: 48px; background: #fff; border-bottom: 1px solid var(--line); display: flex; align-items: center; justify-content: space-between; padding: 0 20px; z-index: 100; }
.brand { font-weight: 700; font-size: 14px; display: flex; align-items: center; gap: 8px; }
.brand span { background: #000; color: #fff; padding: 2px 5px; border-radius: 2px; font-size: 10px; }

.controls select { background: #f9fafb; border: 1px solid var(--line); padding: 4px; border-radius: 4px; font-family: inherit; font-size: 11px; margin-right: 5px; cursor: pointer; }

/* SEARCH */
.search-container { flex: 1; max-width: 300px; margin: 0 20px; }
.search-box { background: #f3f4f6; border-radius: 4px; padding: 4px 10px; display: flex; align-items: center; gap: 8px; border: 1px solid transparent; }
.search-box:focus-within { background: #fff; border-color: var(--accent); }
.search-box input { background: transparent; border: none; outline: none; width: 100%; font-family: inherit; font-size: 12px; }
#search-results-count { font-size: 10px; color: var(--accent); white-space: nowrap; font-weight: 700; }

.actions button { background: #fff; border: 1px solid var(--line); padding: 4px 10px; border-radius: 4px; cursor: pointer; font-family: inherit; font-size: 11px; margin-left: 5px; }
.actions button:hover { background: #f9fafb; border-color: #000; }

/* LAYOUT */
#container { flex: 1; display: flex; overflow: hidden; }
#editor-pane { width: 350px; background: #fff; border-right: 1px solid var(--line); display: flex; flex-direction: column; z-index: 50; transition: transform 0.2s; }
#editor-pane.collapsed { transform: translateX(-100%); position: absolute; height: 100%; }
.editor-header, .editor-footer { padding: 8px 15px; background: #f9fafb; font-size: 10px; color: #6b7280; font-weight: bold; border-bottom: 1px solid var(--line); }
.editor-footer { border-top: 1px solid var(--line); border-bottom: none; }
textarea { flex: 1; padding: 15px; border: none; resize: none; background: transparent; font-family: 'JetBrains Mono', monospace; font-size: 12px; line-height: 1.5; outline: none; }

/* CANVAS */
#canvas-pane { flex: 1; position: relative; background-image: radial-gradient(#d1d5db 1px, transparent 1px); background-size: 20px 20px; cursor: grab; overflow: hidden; }
#canvas-pane:active { cursor: grabbing; }
#infinite-canvas { position: absolute; top: 0; left: 0; transform-origin: 0 0; }

/* NODES */
.node {
    position: absolute; 
    background: var(--node-bg); 
    border: 1px solid #000; 
    padding: 10px; 
    border-radius: 6px;
    font-size: 12px; 
    line-height: 1.4;
    
    /* WRAPPING LOGIC */
    width: 180px;            /* Fixed width */
    white-space: pre-wrap;   /* Wrap text */
    word-break: break-word;
    
    box-shadow: 2px 2px 0px rgba(0,0,0,0.1);
    cursor: pointer; 
    transition: opacity 0.2s, box-shadow 0.2s, transform 0.2s;
}
.node:hover { transform: translateY(-2px); box-shadow: 4px 4px 0px rgba(0,0,0,0.15); z-index: 50; }
.node.root { background: #000; color: #fff; text-align: center; }

/* SEARCH STATES */
.node.dimmed { opacity: 0.2; } /* Grey out non-matches */
.node.highlighted { 
    opacity: 1; 
    outline: 3px solid var(--highlight); 
    box-shadow: 0 0 15px rgba(250, 204, 21, 0.6); 
    z-index: 100;
}

/* LINES */
svg { position: absolute; top: 0; left: 0; overflow: visible; pointer-events: none; }
path { fill: none; stroke-width: 1.5px; transition: opacity 0.2s; }
path.dimmed { opacity: 0.1; }
path.highlighted { stroke-width: 2.5px; opacity: 1; }

#controls-overlay { position: absolute; bottom: 20px; right: 20px; display: flex; flex-direction: column; gap: 5px; }
#controls-overlay button { width: 30px; height: 30px; border: 1px solid var(--line); background: #fff; border-radius: 4px; cursor: pointer; }